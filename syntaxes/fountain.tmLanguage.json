{
  "fileTypes": [
    "fountain"
  ],
  "name": "Fountain",
  "scopeName": "text.source.fountain",
  "uuid": "BA0B1FEB-1E9C-4283-8F3B-E80E7879EA91",
  "patterns": [
    {
      "include": "#dialogue"
    },
    {
      "include": "#block_except_dialogue"
    }
  ],
  "repository": {
    "dialogue_fake": {
      "name": "meta.paragraph.text",
      "begin": "^[ \\t]*(?![#!]|(\\[\\[)|(SUPERIMPOSE:))(((?!@)[^\\p{Ll}\\r\\n]*?\\p{Lu}[^\\p{Ll}\\r\\n]*?)|((@)[^\\r\\n]*?))(\\(.*\\))?(\\s*\\^)?\\s*$",
      "end": "^\\s*$"
    },
    "dialogue": {
      "contentName": "string",
      "begin": "^[ \\t]*(?!\\s*(?:[#!]|(?:\\[\\[)|(?:SUPERIMPOSE:)|(?:/\\*)))(((?!@)[^\\p{Ll}\\r\\n]*\\p{Lu}[^\\p{Ll}\\r\\n]*)|((@)([^\\r\\n]*?)))(\\(.*\\))?(\\s*\\^)?\\s*(?<!\\s*TO:\\s*)$",
      "end": "^\\s*$",
      "beginCaptures": {
        "2": {
          "name": "variable.parameter.url.css"
        },
        "4": {
          "name": "comment.block.fountain"
        },
        "5": {
          "name": "variable.parameter.url.css"
        },
        "6": {
          "name": "constant.numeric.fountain"
        },
        "7": {
          "name": "comment.block.fountain"
        }
      },
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#notes"
        },
        {
          "name": "entity.name.tag",
          "begin": "^[ \\t]*\\(",
          "end": "(\\)\\s*$|(?=^\\s*$))",
          "patterns": [
            {
              "include": "#comments"
            },
            {
              "include": "#notes"
            },
            {
              "include": "#underline"
            },
            {
              "include": "#markup"
            }
          ]
        },
        {
          "include": "#markup"
        },
        {
          "include": "#underline"
        }
      ]
    },
    "block_except_dialogue": {
      "begin": "^(?=\\s*[^\\s]+.*$)",
      "end": "^\\s*$",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#notes"
        },
        {
          "include": "#title_page"
        },
        {
          "include": "#scene_headings"
        },
        {
          "include": "#sections"
        },
        {
          "include": "#synopses"
        },
        {
          "include": "#transitions"
        },
        {
          "include": "#center"
        },
        {
          "include": "#markup"
        },
        {
          "include": "#pagebreaks"
        },
        {
          "include": "#lyrics"
        },
        {
          "include": "#action_force"
        }
      ]
    },
    "comments": {
      "name": "comment.block.fountain",
      "begin": "/\\*",
      "end": "\\*/",
      "patterns": [
        {
          "include": "#comments"
        }
      ]
    },
    "title_page": {
      "begin": "^(?i)(title|credit|authors?|source|draft date|date|watermark|header|footer|contact|contact info|copyright|notes|font|font italic|font bold|font bold italic|revision|tl|tc|tr|cc|br|bl)(:)",
      "end": "^((?=(?i)(title|credit|authors?|source|draft date|date|watermark|header|footer|contact|contact info|copyright|notes|font|font italic|font bold|font bold italic|revision|tl|tc|tr|cc|br|bl))|(?=\\s*$))",
      "name": "meta.paragraph.text",
      "beginCaptures": {
        "1": {
          "name": "keyword.control"
        },
        "2": {
          "name": "keyword.operator"
        }
      },
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#notes"
        }
      ]
    },
    "scene_headings": {
      "match": "(?i)^[ \\t]*([.](?=[\\w\\(\\p{L}])(?:\\(室内\\)|\\(室外\\))?|(?:int|ext|est|int[.]?\\/ext|i[.]?\\/e)[.\\s]\\s*(?:\\(室内\\)|\\(室外\\))?)(.*)((#)\\s*([^\\s].*)(#))?\\s*$",
      "captures": {
        "1": {
          "name": "keyword.other.class"
        },
        "2": {
          "name": "token.error-token"
        },
        "4": {
          "name": "comment.block.fountain"
        },
        "5": {
          "name": "constant.numeric.scene.fountain"
        },
        "6": {
          "name": "comment.block.fountain"
        }
      }
    },
    "sections": {
      "match": "^[ \\t]*(#+)(?:\\s*)(.*)",
      "captures": {
        "1": {
          "name": "comment.block.fountain"
        },
        "2": {
          "name": "variable.other.constant"
        }
      }
    },
    "synopses": {
      "name": "constant.numeric.scene.fountain",
      "begin": "^(={1})(?!=)",
      "end": "$",
      "captures": {
        "1": {
          "name": "comment.block.fountain"
        }
      },
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#notes"
        },
        {
          "include": "#underline"
        },
        {
          "include": "#markup"
        }
      ]
    },
    "transitions": {
      "name": "variable.other.constant",
      "match": "^\\s*(?:(>)[^<\\n\\r]*|[A-Z ]+TO:)$",
      "captures": {
        "1": {
          "name": "comment.block.fountain"
        }
      }
    },
    "center": {
      "name": "token.warn-token",
      "begin": "^\\s*(>)",
      "end": "(<)\\s*$",
      "captures": {
        "1": {
          "name": "comment.block.fountain"
        }
      },
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#notes"
        },
        {
          "include": "#underline"
        },
        {
          "include": "#markup"
        }
      ]
    },
    "notes": {
      "name": "comment.block",
      "begin": "\\[{2}",
      "end": "\\]{2}",
      "patterns": [
        {
          "include": "#notes"
        },
        {
          "include": "#underline"
        },
        {
          "include": "#markup"
        }
      ]
    },
    "pagebreaks": {
      "name": "variable.other.constant",
      "match": "^\\s*={3,}$"
    },
    "lyrics": {
      "name": "markup.italic string",
      "begin": "^\\s*(~)",
      "end": "$",
      "beginCaptures" :{
        "1": {
          "name": "comment.block.fountain"
        }
      },
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#notes"
        },
        {
          "include": "#underline"
        },
        {
          "include": "#markup"
        }
      ]
    },
    "action_force": {
      "begin": "^\\s*(\\!)",
      "end": "$",
      "beginCaptures" :{
        "1": {
          "name": "comment.block.fountain"
        }
      },
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#notes"
        },
        {
          "include": "#underline"
        },
        {
          "include": "#markup"
        }
      ]
    },
    "underline": {
      "name": "markup.underline.fountain",
      "begin": "(?<!\\\\)_",
      "end": "(?<!\\\\)_",
      "patterns": [
        {
          "include": "#comments"
        },
        {
          "include": "#notes"
        },
        {
          "include": "#markup"
        }
      ]
    },
    "markup": {
      "patterns": [
        {
          "name": "markup.bold.fountain",
          "begin": "(?<!\\\\|/)(\\*{2,3})(?!/)",
          "captures": {
            "1": {
              "name": "punctuation.definition.markup.bold.fountain"
            }
          },
          "end": "(?<!\\\\|/)(\\1)(?!/)",
          "patterns": [
            {
              "include": "#comments"
            },
            {
              "include": "#notes"
            },
            {
              "applyEndPatternLast": 1,
              "begin": "(?=<[^>]*?>)",
              "end": "(?<=>)",
              "patterns": [
                {
                  "include": "text.html.basic"
                }
              ]
            }
          ]
        },
        {
          "name": "markup.italic.fountain",
          "begin": "(?<!\\\\|/)(\\*)(?!/)",
          "captures": {
            "1": {
              "name": "punctuation.definition.markup.italic.fountain"
            }
          },
          "end": "(?<!\\\\|/)(\\1)(?!/)",
          "patterns": [
            {
              "include": "#comments"
            },
            {
              "include": "#notes"
            },
            {
              "applyEndPatternLast": 1,
              "begin": "(?=<[^>]*?>)",
              "end": "(?<=>)",
              "patterns": [
                {
                  "include": "text.html.basic"
                }
              ]
            }
          ]
        }
      ]
    },
    "link-inline": {
      "captures": {
        "1": {
          "name": "punctuation.definition.tag"
        },
        "3": {
          "name": "punctuation.definition.tag"
        },
        "5": {
          "name": "punctuation.definition.tag"
        },
        "6": {
          "name": "punctuation.definition.tag"
        },
        "10": {
          "name": "punctuation.definition.tag"
        },
        "4": {
          "name": "markup.underline.link.fountain",
          "patterns": [
            {
              "include": "#markup"
            },
            {
              "include": "#link-inline"
            }
          ]
        },
        "7": {
          "name": "keyword"
        }
      },
      "match": "(!)?(\\[?(\\[)([^\\]\\[]*\\[?[^\\]\\[]*\\]?[^\\]\\[]*)(\\])(\\()(.+?)(?:\\s+([\"'])(.*?)\\4)?(\\)))",
      "name": "meta.link.inline.fountain"
    },
    "test2": {
      "name": "variable.other.constant",
      "begin": "^(?!\\s*$).*$",
      "while": "^(?!\\s*$).*$"
    }
  }
}